---
title: "F1Modeling"
author: "Derek Rogers"
date: "2023-02-03"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r}
library(dplyr)
library(ggplot2)
```

# Import modeling data

Includes all race results since 1989 with attributes:

  - Drive name/id   // currently only the 25 drivers with the most race results have a unique name. All other drivers have there names labeled 'Other'
  
  - Constructor name/id   // currently only the 25 constructors with the most reace results have a unique name. All other constructors have there names labeled 'Other' 
  
  - Race name/id
  
  - Starting position labeled 'grid'
  
  - Finishing position labeled 'positionOrder'
  
  - The altitude the track is at
  
  - The era of engine specifications

```{r}
F1DataFrame = read.csv("C:/SMU MS Data Science/AppliedStatistics6372/Project1/F1ParametricModeling/ModelingData/F1ModelingCustomCategoricalVariables.csv")

F1DataFrame
```

# Residuals Vs Fitted Plot 

Shows evidence of a negative slope with variance that seems to increase as fitted values increase. 

This means the model is on average predicting worse results for drivers who finish with a good results. As the fitted values increase it seems to get a wider difference in predicted vs actual results.

# Q-Q Plot

 suggests a normal distribution can be assumed
 
# Scale-Location Plot

 Provides more evidence for normality
 
 There seems to be a patterns in starting at each discrete fitted value and traveling parallel to the Y axis with a sin function but with sharp 90 degree transitions.
 
 Currently we don't have an explanation for why this is.

```{r}
mymodel<-lm(positionOrder ~ grid + name + fullname + era, data = F1DataFrame)
par(mfrow = c(1,1))
plot(mymodel)
```

# Summary Statistics of the model

The model doesn't not perform well With R-squared values at 0.27

Surprisingly starting position doesn't appear to be statistically significant which doesn't make sense. One would expect there to be a strong correlation between starting position and finishing position.

```{r}
summary(mymodel)
```

# Starting position analysis

The grouping of low starting positions and high finishing positions during the era of up to 12 cylinders explains the irregularities from normality in the models residual plots and lack of statistical significance in the model for stating position.

```{r}
mymodel<-lm(positionOrder ~ grid, data = F1DataFrame)

ggplot(data = F1DataFrame, aes(x = grid, y = positionOrder, colour = era)) + 
  geom_point(position = "jitter") +
  labs(title="starting vs finishing position by era", 
     y="finishing position", 
     x="starting position")
```

Plots look similar to the full model as expected

```{r}
mymodel<-lm(positionOrder ~ grid, data = F1DataFrame)
par(mfrow = c(1,1))
plot(mymodel)
```

# Model with interaction term between grid and era

The residual plots look similar to the first model

```{r}
mymodel<-lm(positionOrder ~ grid + name + fullname + era + grid:era, data = F1DataFrame)
par(mfrow = c(1,1))
plot(mymodel)
```

# Summary statistics with interaction term between grid and era

The model performs significantly better With R-squared values going from 0.27 to 0.32

Surprisingly starting position doesn't appear to be statistically significant which doesn't make sense. One would expect there to be a strong correlation between starting position and finishing position.

```{r}
summary(mymodel)
```